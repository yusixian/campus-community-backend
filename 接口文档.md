<!--
 * @Author: 41
 * @Date: 2022-02-15 17:53:43
 * @LastEditors: lihao
 * @LastEditTime: 2022-02-21 18:50:43
 * @Description: 
-->
# 数据库
### 用户表
|字段名|字段类型| 说明|
|--|--|--|
|id|int|主键,自增|
|user_name|varchar(255)|用户名,unique|
|password|char(64)|密码|
|is_admin|tinyint(1)|0:不是管理员 1:是管理员|

### 文章表 sc_Articles

| 字段名       | 字段类型     | 允许为空 | 说明                    |
| ------------ | ------------ | -------- | ----------------------- |
| id           | int          | N        | 文章id                  |
| user_id      | int          | N        | 发贴用户id              |
| user_name    | varchar(255) | N        | 发贴用户名              |
| is_admin     | tinyint(1)   | N        | 0:不是管理员 1:是管理员 |
| title        | varchar(255) | N        | 文章标题                |
| summary      | varchar(255) | Y        | 文章摘要：纯文本        |
| content      | text         | N        | 文章详情：可以为富文本  |
| partition_id | int          | N        | 分区号                  |
| comments     | int          | N        | 评论数 初始为0          |
| likes        | int          | N        | 点赞数 初始为0          |
| collections  | int          | N        | 收藏数 初始为0          |
| visits       | int          | N        | 浏览数 初始为0          |

### 分区表

| 字段名         | 字段类型     | 说明             |
| -------------- | ------------ | ---------------- |
| id             | int          | 主键,自增        |
| partition_name | varchar(255) | 分区的名称       |
| partition_desc | varchar(255) | 分区的描述       |
| cre_user_id    | int          | 创建分区的用户id |

### 评论表
| 字段名         | 字段类型     | 说明             |
| -------------- | ------------ | ---------------- |
| id             | int          | 主键,自增        |
| comment_content | varchar(255) | 评论的内容       |
| user_id | int | 写评论的用户id       |
| article_id    | int          | 被评论的文章id |

# 接口设计

## 用户模块
### 注册接口
```bash
POST/users/register
```
- 请求参数
```
user_name,password
```
- 响应

**成功**
```JSON
{
  "code":0,
  "message":"用户注册成功",
  "result":{
    "id":2,
    "user_name":"user"
  }
}
```
**失败**
```JSON
{
  "code":"10001",
  "message":"用户名或密码不能为空",
  "result":""
}
{
  "code":"10002",
  "message":"用户已经存在",
  "result":""
}
{
  "code":"10003",
  "message":"用户注册失败",
  "result":""
}
```
***
### 登录接口
```bash
POST/users/login
```
- 请求参数
```
user_name,password
```
- 响应

**成功**
```JSON
{
    "code": 0,
    "message": "用户登录成功",
    "result": {
        "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NCwidXNlcl9uYW1lIjoi5bCP5piOMiIsImlzX2FkbWluIjpmYWxzZSwiaWF0IjoxNjQ1MDc5NjA4LCJleHAiOjE2NDUxNjYwMDh9.-F905vX9_n3s7fZGkJVXuZ9Y1LRwLvvAAEG1j4gXB8E"
    }
}
```

**失败**
```JSON
{
  "code": "10004",
  "message": "用户不存在",
  "result": ""
}
{
  "code": "10005",
  "message": "用户登录失败",
  "result": ""
}
{
  "code": "10006",
  "message": "密码不匹配",
  "result": ""
}
```
***
### 修改密码接口
- 请求参数
```
password
```
- 响应

**成功**
```JSON
{
  "code":0,
  "message":"修改密码成功",
  "result":""
}
```

**失败**

```JSON
{
  "code": "10101",
  "message": "token已过期",
  "result": ""
}
{
  "code": "10102",
  "message": "token无效",
  "result": ""
}
{
  "code": "10007",
  "message": "修改密码失败",
  "result": ""
}
```

---

## 发帖管理模块

### DELETE 屏蔽文章

DELETE /articles/shield

#### 请求参数

| 名称       | 位置  | 类型   | 必选  | 说明         |
| ---------- | ----- | ------ | ----- | ------------ |
| article_id | query | string | false | 待屏蔽文章id |

> 返回示例

#### 返回结果

| 状态码 | 状态码含义                                              | 说明 | 数据模型 |
| ------ | ------------------------------------------------------- | ---- | -------- |
| 200    | [OK](https://tools.ietf.org/html/rfc7231#section-6.3.1) | 成功 | Inline   |

#### 返回数据结构

### DELETE 删除文章

DELETE /articles/delete

根据文章id删除文章

> Body 请求参数

```yaml
{}

```

#### 请求参数

| 名称       | 位置  | 类型   | 必选  | 说明         |
| ---------- | ----- | ------ | ----- | ------------ |
| article_id | query | string | true  | 待删除文章ID |
| body       | body  | object | false | none         |

> 返回示例

> 成功

```json
{
  "code": 0,
  "message": "删除文章成功！"
}
```

> 记录不存在

```json
{
  "code": "11004",
  "message": "该文章不存在！"
}
```

#### 返回结果

| 状态码 | 状态码含义                                                   | 说明       | 数据模型 |
| ------ | ------------------------------------------------------------ | ---------- | -------- |
| 200    | [OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)      | 成功       | Inline   |
| 404    | [Not Found](https://tools.ietf.org/html/rfc7231#section-6.5.4) | 记录不存在 | Inline   |

#### 返回数据结构

状态码 **200**

| 名称      | 类型    | 必选 | 约束 | 说明     |
| --------- | ------- | ---- | ---- | -------- |
| » code    | integer | true | none | none     |
| » message | string  | true | none | 提示文本 |

状态码 **404**

| 名称      | 类型   | 必选 | 约束 | 说明     |
| --------- | ------ | ---- | ---- | -------- |
| » code    | string | true | none | 错误码   |
| » message | string | true | none | 提示语句 |

### GET 获取所有文章

GET /articles/search

> 返回示例

> 成功

```json
{
  "code": 0,
  "message": "获取文章列表成功！",
  "result": [
    {
      "id": 1,
      "user_id": 1,
      "user_name": "admin",
      "is_admin": 1,
      "title": "体转共切报程",
      "summary": "图写适属增毛理研七收准石平度公须。",
      "content": "何到眼写属了或深边么众价总科光。资更江共重团声被按支心总其关放细务。复许世管样最象应青称维用系作活些。消同点回常拉法传县安提不。",
      "partition_id": 1,
      "comments": 0,
      "likes": 0,
      "collections": 0,
      "visits": 0,
      "createdAt": "2022-02-20T12:51:57.000Z",
      "updatedAt": "2022-02-20T12:51:57.000Z",
      "deletedAt": null
    },
    {
      "id": 2,
      "user_id": 1,
      "user_name": "admin",
      "is_admin": 1,
      "title": "济少把保变立",
      "summary": "定叫器式业更化叫那引生记育行。",
      "content": "需确公空义十业委听打再明算。毛解知机积两世即从传先题流。都也无提采书济该劳它六较。史会情离己般只即比一断七把志结严导回。",
      "partition_id": 1,
      "comments": 0,
      "likes": 0,
      "collections": 0,
      "visits": 0,
      "createdAt": "2022-02-20T12:51:57.000Z",
      "updatedAt": "2022-02-20T12:51:57.000Z",
      "deletedAt": null
    },
    // ....
  ]
}
```

#### 返回结果

| 状态码 | 状态码含义                                              | 说明 | 数据模型 |
| ------ | ------------------------------------------------------- | ---- | -------- |
| 200    | [OK](https://tools.ietf.org/html/rfc7231#section-6.3.1) | 成功 | Inline   |

#### 返回数据结构

状态码 **200**

| 名称            | 类型        | 必选 | 约束 | 说明                 |
| --------------- | ----------- | ---- | ---- | -------------------- |
| » code          | integer     | true | none | none                 |
| » message       | string      | true | none | none                 |
| » result        | [object]    | true | none | none                 |
| »» id           | integer     | true | none | none                 |
| »» user_id      | integer     | true | none | none                 |
| »» user_name    | string      | true | none | none                 |
| »» is_admin     | integer     | true | none | none                 |
| »» title        | string      | true | none | none                 |
| »» summary      | string¦null | true | none | none                 |
| »» content      | string      | true | none | none                 |
| »» partition_id | integer     | true | none | none                 |
| »» comments     | integer     | true | none | none                 |
| »» likes        | integer     | true | none | none                 |
| »» collections  | integer     | true | none | none                 |
| »» visits       | integer     | true | none | none                 |
| »» createdAt    | string      | true | none | none                 |
| »» updatedAt    | string      | true | none | none                 |
| »» deletedAt    | null        | true | none | 软删除则不会有该字段 |

### POST 恢复文章

POST /articles/restore

#### 请求参数

| 名称       | 位置  | 类型   | 必选 | 说明 |
| ---------- | ----- | ------ | ---- | ---- |
| article_id | query | string | true | none |

> 返回示例

#### 返回结果

| 状态码 | 状态码含义                                              | 说明 | 数据模型 |
| ------ | ------------------------------------------------------- | ---- | -------- |
| 200    | [OK](https://tools.ietf.org/html/rfc7231#section-6.3.1) | 成功 | Inline   |

#### 返回数据结构

### POST 发表文章

POST /articles/create

> Body 请求参数

```json
{
  "title": "【第二届青训营-寒假前端场】- 「Node.js 与前端开发实战」",
  "summary": "这节课从Node.js介绍起，实现了其编写Http Server的一个实战（并用Promise优化回调，还对SSR有了一定的了解），并在延伸话题里老师也给出了一些建议与拓展阅读，好欸~",
  "content": "早期的jQuery等库都是直接在页面中引入，后来模块化逐渐成熟，Node.js赋予了开发者在浏览器外运行代码的能力，前端逐渐模块化。一个常见场景：读取文件时。当Node.js执行I/O操作时，会在响应返回后恢复操作，而不是阻塞线程并占用额外内存等待。（内存占用更少）"
}
```

#### 请求参数

| 名称      | 位置 | 类型        | 必选  | 说明         |
| --------- | ---- | ----------- | ----- | ------------ |
| body      | body | object      | false | none         |
| » content | body | string      | true  | 可以是富文本 |
| » summary | body | string¦null | false | 文章摘要     |
| » title   | body | string      | true  | 文章标题     |

> 返回示例

> 成功

```json
{
  "code": 0,
  "message": "发帖成功！",
  "result": {
    "article_id": 1,
    "user_id": 1,
    "user_name": "admin",
    "title": "【第二届青训营-寒假前端场】- 「Node.js 与前端开发实战」"
  }
}
```

> 请求有误

```json
{
  "code": "11003",
  "message": "文章标题或内容为空"
}
```

#### 返回结果

| 状态码 | 状态码含义                                                   | 说明     | 数据模型 |
| ------ | ------------------------------------------------------------ | -------- | -------- |
| 200    | [OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)      | 成功     | Inline   |
| 400    | [Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1) | 请求有误 | Inline   |

#### 返回数据结构

状态码 **200**

| 名称          | 类型    | 必选 | 约束 | 说明                   |
| ------------- | ------- | ---- | ---- | ---------------------- |
| » code        | integer | true | none | none                   |
| » message     | string  | true | none | 提示文本               |
| » result      | object  | true | none | 返回数据               |
| »» article_id | integer | true | none | 数据库中该文章所对应ID |
| »» user_id    | integer | true | none | 发帖用户名             |
| »» user_name  | string  | true | none | 发帖用户名             |
| »» title      | string  | true | none | 文章标题               |

状态码 **400**

| 名称      | 类型   | 必选 | 约束 | 说明     |
| --------- | ------ | ---- | ---- | -------- |
| » code    | string | true | none | 错误码   |
| » message | string | true | none | 提示信息 |

### PATCH 更新文章

PATCH /articles/update

> Body 请求参数

```json
{
  "id": 1,
  "title": "这是一个新的标题",
  "summary": "这是一个新的摘要",
  "content": "这是一个新的内容"
}
```

#### 请求参数

| 名称      | 位置 | 类型        | 必选  | 说明                       |
| --------- | ---- | ----------- | ----- | -------------------------- |
| body      | body | object      | false | none                       |
| » content | body | string      | false | 更新后的内容，可以是富文本 |
| » summary | body | string¦null | false | 更新后的文章摘要           |
| » title   | body | string      | false | 更新后的文章标题           |
| » id      | body | integer     | true  | 待更新文章ID               |

> 返回示例

#### 返回结果

| 状态码 | 状态码含义                                                   | 说明       | 数据模型 |
| ------ | ------------------------------------------------------------ | ---------- | -------- |
| 200    | [OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)      | 成功       | Inline   |
| 404    | [Not Found](https://tools.ietf.org/html/rfc7231#section-6.5.4) | 记录不存在 | Inline   |

#### 返回数据结构

状态码 **200**

| 名称      | 类型    | 必选 | 约束 | 说明     |
| --------- | ------- | ---- | ---- | -------- |
| » code    | integer | true | none | none     |
| » message | string  | true | none | 提示文本 |

状态码 **404**

| 名称      | 类型   | 必选 | 约束 | 说明     |
| --------- | ------ | ---- | ---- | -------- |
| » code    | string | true | none | 错误码   |
| » message | string | true | none | 提示信息 |

# 分区接口

## GET 查询所有分区

GET /partition/queryAllPartition

> 返回示例

> 成功

```json
{
  "code": 0,
  "message": "查询所有分区成功",
  "result": [
    {
      "id": 1,
      "partition_name": "分区测试",
      "partition_desc": "用于测试分区模块",
      "cre_user_id": 1,
      "createdAt": "2022-02-21T10:26:11.000Z",
      "updatedAt": "2022-02-21T10:26:11.000Z"
    }
  ]
}
```

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## POST 创建分区接口

POST /partition/insertPartition

> Body 请求参数

```json
{
  "partition_name": "分区测试",
  "partition_desc": "用于测试分区模块"
}
```

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|body|body|object|false|none|
|» partition_name|body|string|true|分区名称|
|» partition_desc|body|string|true|分区描述|

> 返回示例

> 成功

```json
{
  "code": 0,
  "message": "分区创建成功",
  "result": ""
}
```

```json
{
  "code": "12001",
  "message": "创建分区失败",
  "result": ""
}
```

```json
{
  "code": "12002",
  "message": "分区名称已存在",
  "result": ""
}
```

```json
{
  "code": "12003",
  "message": "分区名称不可以为空",
  "result": ""
}
```

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|


状态码 **200**

|名称|类型|必选|约束|说明|
|---|---|---|---|---|
|» code|string|true|none|none|
|» message|string|true|none|none|
|» result|object|true|none|none|

## DELETE 删除分区接口

DELETE /partition/deletePartition

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|id|query|string|false|none|

> 返回示例

> 成功

```json
{
  "code": 0,
  "message": "分区删除成功",
  "result": ""
}
```

```json
{
  "code": "12004",
  "message": "分区删除失败",
  "result": ""
}
```

```json
{
  "code": "12005",
  "message": "分区id为空",
  "result": ""
}
```

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|


状态码 **200**

|名称|类型|必选|约束|说明|
|---|---|---|---|---|
|» code|string|true|none|none|
|» message|string|true|none|none|
|» result|object|true|none|none|

# 评论接口

## GET 根据文章id获取评论

GET /comment/queryCommentByArticleId

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|id|query|string|false|none|

> 返回示例

> 成功

```json
{
  "code": 0,
  "message": "查询评论成功",
  "result": [
    {
      "id": 1,
      "comment_content": "哈哈哈",
      "user_id": 1,
      "article_id": 1,
      "createdAt": "2022-02-21T07:52:58.000Z",
      "updatedAt": "2022-02-21T07:52:58.000Z",
      "deletedAt": null
    },
    {
      "id": 2,
      "comment_content": "哈哈哈",
      "user_id": 1,
      "article_id": 1,
      "createdAt": "2022-02-21T08:35:31.000Z",
      "updatedAt": "2022-02-21T08:35:31.000Z",
      "deletedAt": null
    },
    {
      "id": 3,
      "comment_content": "哈哈哈2",
      "user_id": 1,
      "article_id": 1,
      "createdAt": "2022-02-21T08:36:50.000Z",
      "updatedAt": "2022-02-21T08:36:50.000Z",
      "deletedAt": null
    }
  ]
}
```

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|


## DELETE 删除评论

DELETE /comment/deleteComment

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|id|query|string|false|none|

> 返回示例

> 成功

```json
{
  "code": 0,
  "message": "删除评论成功",
  "result": ""
}
```

```json
{
  "code": "13003",
  "message": "评论id不可以为空",
  "result": ""
}
```

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|


## PATCH 恢复评论

PATCH /comment/restoreComment

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|id|query|string|false|none|

> 返回示例

> 成功

```json
{
  "code": "10103",
  "message": "未授权,当前请求需要管理员权限",
  "result": ""
}
```

```json
{
  "code": "13003",
  "message": "评论id不可以为空",
  "result": ""
}
```

```json
{
  "code": 0,
  "message": "恢复评论成功",
  "result": ""
}
```

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|



## POST 新增评论的接口

POST /comment/createComment

> Body 请求参数

```json
{
  "comment_content": "string",
  "article_id": 0
}
```

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|body|body|object|false|none|
|» comment_content|body|string|true|none|
|» article_id|body|integer|true|none|

> 返回示例

> 成功

```json
{
  "code": 0,
  "message": "评论成功",
  "result": ""
}
```

```json
{
  "code": "13002",
  "message": "评论内容和评论文章不可以为空",
  "result": ""
}
```

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|



